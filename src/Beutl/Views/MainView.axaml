<UserControl x:Class="Beutl.Views.MainView"
             xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:ctrl="using:Beutl.Controls"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:icons="using:FluentIcons.FluentAvalonia"
             xmlns:interactivity="using:Avalonia.Xaml.Interactivity"
             xmlns:lang="using:Beutl.Language"
             xmlns:local="using:Beutl.Views"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:pages="using:Beutl.Pages"
             xmlns:ui="using:FluentAvalonia.UI.Controls"
             xmlns:uip="using:FluentAvalonia.UI.Controls.Primitives"
             xmlns:vm="using:Beutl.ViewModels"
             xmlns:wnd="using:FluentAvalonia.UI.Windowing"
             x:Name="root"
             Padding="0"
             d:DesignHeight="450"
             d:DesignWidth="800"
             x:DataType="vm:MainViewModel"
             Focusable="True"
             mc:Ignorable="d">

    <Design.DataContext>
        <vm:MainViewModel />
    </Design.DataContext>

    <UserControl.KeyBindings>
        <KeyBinding Command="{CompiledBinding CreateNewProject}" Gesture="{DynamicResource CreateNewProjectKeyGesture}" />
        <KeyBinding Command="{CompiledBinding CreateNew}" Gesture="{DynamicResource CreateNewKeyGesture}" />
        <KeyBinding Command="{CompiledBinding OpenProject}" Gesture="{DynamicResource OpenProjectKeyGesture}" />
        <KeyBinding Command="{CompiledBinding OpenFile}" Gesture="{DynamicResource OpenKeyGesture}" />
        <KeyBinding Command="{CompiledBinding Save}" Gesture="{DynamicResource SaveKeyGesture}" />
        <KeyBinding Command="{CompiledBinding SaveAll}" Gesture="{DynamicResource SaveAllKeyGesture}" />
        <KeyBinding Command="{CompiledBinding Exit}" Gesture="{DynamicResource ExitKeyGesture}" />
        <KeyBinding Command="{CompiledBinding Undo}" Gesture="{DynamicResource UndoKeyGesture}" />
        <KeyBinding Command="{CompiledBinding Redo}" Gesture="{DynamicResource RedoKeyGesture}" />
    </UserControl.KeyBindings>

    <Grid RowDefinitions="Auto,*">
        <Grid x:Name="Titlebar" ColumnDefinitions="Auto,Auto,*">
            <Image MaxWidth="24"
                   MaxHeight="24"
                   Margin="8,0"
                   VerticalAlignment="Center"
                   Source="/Assets/logo.ico">
                <Image.Clip>
                    <EllipseGeometry RadiusX="12"
                                     RadiusY="12"
                                     Rect="0,0,24,24" />
                </Image.Clip>
            </Image>

            <Menu x:Name="MenuBar"
                  Grid.Column="1"
                  wnd:AppWindow.AllowInteractionInTitleBar="True">
                <!--  ファイル  -->
                <MenuItem Header="{x:Static lang:Strings.File}">
                    <!--  新規作成  -->
                    <MenuItem Header="{x:Static lang:Strings.CreateNew}">
                        <MenuItem.Icon>
                            <icons:SymbolIcon Symbol="New" />
                        </MenuItem.Icon>
                        <!--  プロジェクト  -->
                        <MenuItem Command="{CompiledBinding CreateNewProject}"
                                  Header="{x:Static lang:Strings.CreateNewProject}"
                                  InputGesture="{DynamicResource CreateNewProjectKeyGesture}" />
                        <!--  ファイル  -->
                        <MenuItem Command="{CompiledBinding CreateNew}"
                                  Header="{x:Static lang:Strings.CreateNewScene}"
                                  InputGesture="{DynamicResource CreateNewKeyGesture}" />
                    </MenuItem>
                    <Separator />
                    <!--  開く  -->
                    <MenuItem Header="{x:Static lang:Strings.Open}">
                        <MenuItem.Icon>
                            <icons:SymbolIcon Symbol="Open" />
                        </MenuItem.Icon>
                        <!--  プロジェクト  -->
                        <MenuItem Command="{CompiledBinding OpenProject}"
                                  Header="{x:Static lang:Strings.Project}"
                                  InputGesture="{DynamicResource OpenProjectKeyGesture}" />
                        <!--  ファイル  -->
                        <MenuItem Command="{CompiledBinding OpenFile}"
                                  Header="{x:Static lang:Strings.File}"
                                  InputGesture="{DynamicResource OpenKeyGesture}" />
                    </MenuItem>
                    <Separator />
                    <!--  閉じる  -->
                    <MenuItem Command="{CompiledBinding CloseFile}" Header="{x:Static lang:Strings.Close}" />
                    <!--  プロジェクトを閉じる  -->
                    <MenuItem Command="{CompiledBinding CloseProject}"
                              Header="{x:Static lang:Strings.CloseProject}"
                              IsEnabled="{CompiledBinding IsProjectOpened.Value}" />
                    <Separator />
                    <!--  上書き保存  -->
                    <MenuItem Command="{CompiledBinding Save}"
                              Header="{x:Static lang:Strings.Save}"
                              InputGesture="{DynamicResource SaveKeyGesture}"
                              IsEnabled="{CompiledBinding IsProjectOpened.Value}">
                        <MenuItem.Icon>
                            <icons:SymbolIcon Symbol="Save" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <!--  すべて保存  -->
                    <MenuItem Command="{CompiledBinding SaveAll}"
                              Header="{x:Static lang:Strings.SaveAll}"
                              InputGesture="{DynamicResource SaveAllKeyGesture}"
                              IsEnabled="{CompiledBinding IsProjectOpened.Value}">
                        <MenuItem.Icon>
                            <icons:SymbolIcon Symbol="SaveMultiple" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <Separator />
                    <!--  最近使ったプロジェクト  -->
                    <MenuItem x:Name="recentFiles" Header="{x:Static lang:Strings.RecentFiles}" />
                    <MenuItem x:Name="recentProjects" Header="{x:Static lang:Strings.RecentProjects}" />

                    <Separator />
                    <!--  終了  -->
                    <MenuItem Command="{CompiledBinding Exit}"
                              Header="{x:Static lang:Strings.Exit}"
                              InputGesture="{DynamicResource ExitKeyGesture}" />
                </MenuItem>
                <!--  編集  -->
                <MenuItem Header="{x:Static lang:Strings.Edit}">
                    <!--  元に戻す  -->
                    <MenuItem Command="{CompiledBinding Undo}"
                              Header="{x:Static lang:Strings.Undo}"
                              InputGesture="{DynamicResource UndoKeyGesture}"
                              IsEnabled="{CompiledBinding IsProjectOpened.Value}">
                        <MenuItem.Icon>
                            <icons:SymbolIcon Symbol="ArrowUndo" />
                        </MenuItem.Icon>
                    </MenuItem>
                    <!--  やり直し  -->
                    <MenuItem Command="{CompiledBinding Redo}"
                              Header="{x:Static lang:Strings.Redo}"
                              InputGesture="{DynamicResource RedoKeyGesture}"
                              IsEnabled="{CompiledBinding IsProjectOpened.Value}">
                        <MenuItem.Icon>
                            <icons:SymbolIcon Symbol="ArrowRedo" />
                        </MenuItem.Icon>
                    </MenuItem>
                </MenuItem>
                <!--  表示  -->
                <MenuItem x:Name="viewMenuItem" Header="{x:Static lang:Strings.View}">
                    <MenuItem x:Name="editorTabMenuItem" Header="{x:Static lang:Strings.Editors}" />
                    <MenuItem x:Name="toolTabMenuItem" Header="{x:Static lang:Strings.Tools}" />
                </MenuItem>
                <!--  プロジェクト  -->
                <MenuItem Header="{x:Static lang:Strings.Project}">
                    <MenuItem Command="{CompiledBinding AddToProject}" Header="{x:Static lang:Strings.Add}" />
                    <MenuItem Command="{CompiledBinding RemoveFromProject}" Header="{x:Static lang:Strings.Remove}" />
                </MenuItem>
                <!--  シーン  -->
                <MenuItem Header="{x:Static lang:Strings.Scene}">
                    <MenuItem Command="{CompiledBinding NewScene}" Header="{x:Static lang:Strings.CreateNew}" />
                    <MenuItem Click="SceneSettings_Click"
                              Header="{x:Static lang:Strings.SceneSettings}"
                              IsEnabled="{CompiledBinding IsProjectOpened.Value}" />
                    <!--  レイヤー  -->
                    <MenuItem Header="{x:Static lang:Strings.Layer}">
                        <MenuItem Command="{CompiledBinding AddLayer}" Header="{x:Static lang:Strings.Add}" />
                        <MenuItem Command="{CompiledBinding DeleteLayer}" Header="{x:Static lang:Strings.Delete}" />
                        <MenuItem Command="{CompiledBinding ExcludeLayer}" Header="{x:Static lang:Strings.Exclude}" />
                        <MenuItem Command="{CompiledBinding CutLayer}" Header="{x:Static lang:Strings.Cut}" />
                        <MenuItem Command="{CompiledBinding CopyLayer}" Header="{x:Static lang:Strings.Copy}" />
                        <MenuItem Command="{CompiledBinding PasteLayer}" Header="{x:Static lang:Strings.Paste}" />
                    </MenuItem>
                </MenuItem>
                <!--  オブジェクト  -->
                <MenuItem Header="{x:Static lang:Strings.Object}" />
                <!--  ヘルプ  -->
                <MenuItem Header="{x:Static lang:Strings.Help}" />
            </Menu>

            <Border Grid.Column="2"
                    Padding="4"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Background="{DynamicResource ControlFillColorDefaultBrush}"
                    IsVisible="{CompiledBinding IsDebuggerAttached}">
                <TextBlock Text="Debug" />
            </Border>
        </Grid>

        <ui:NavigationView x:Name="Navi"
                           Grid.Row="1"
                           Classes="SideNavigationView"
                           IsSettingsVisible="False">
            <ui:NavigationView.FooterMenuItems>
                <ui:NavigationViewItem x:Name="SettingsPageItem"
                                       Classes="SideNavigationViewItem"
                                       Content="{x:Static lang:Strings.Settings}"
                                       DataContext="{CompiledBinding SettingsPage}">
                    <interactivity:Interaction.Behaviors>
                        <interactivity:BehaviorCollection>
                            <ctrl:NavItemHelper>
                                <ctrl:NavItemHelper.FilledIcon>
                                    <icons:SymbolIconSource Symbol="Settings" />
                                </ctrl:NavItemHelper.FilledIcon>
                                <ctrl:NavItemHelper.RegularIcon>
                                    <icons:SymbolIconSource Symbol="Settings" />
                                </ctrl:NavItemHelper.RegularIcon>
                            </ctrl:NavItemHelper>
                        </interactivity:BehaviorCollection>
                    </interactivity:Interaction.Behaviors>
                </ui:NavigationViewItem>
            </ui:NavigationView.FooterMenuItems>

            <!--<TransitioningContentControl x:Name="NaviContent" />-->
            <Panel x:Name="NaviContent" />
        </ui:NavigationView>
    </Grid>

</UserControl>
