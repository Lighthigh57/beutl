<UserControl x:Class="Beutl.Views.Library"
             xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:anmeditors="using:Beutl.Views.AnimationEditors"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:icons="using:FluentIcons.FluentAvalonia"
             xmlns:lang="using:Beutl.Language"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:ui="using:FluentAvalonia.UI.Controls"
             xmlns:viewModel="using:Beutl.ViewModels"
             d:DesignHeight="450"
             d:DesignWidth="300"
             x:DataType="viewModel:LibraryViewModel"
             mc:Ignorable="d">
    <Grid RowDefinitions="Auto,*">
        <TabStrip x:Name="tabStrip"
                  Margin="0,2"
                  SelectedIndex="1"
                  Theme="{StaticResource LiteNavTabStrip}">
            <TabStrip.Styles>
                <Style Selector="TabStripItem">
                    <Setter Property="Padding" Value="12,5,12,3" />
                    <Setter Property="ToolTip.Tip" Value="{Binding $self.Content.Children[1].Text}" />

                    <Style Selector="^ > StackPanel">
                        <Setter Property="Spacing" Value="4" />
                        <Setter Property="Orientation" Value="Horizontal" />

                        <Style Selector="^ > TextBlock">
                            <Setter Property="IsVisible" Value="{Binding $parent[TabStripItem].IsSelected}" />
                        </Style>
                        <Style Selector="^ > icons|SymbolIcon">
                            <Setter Property="FontSize" Value="20" />
                        </Style>
                    </Style>
                </Style>
            </TabStrip.Styles>
            <TabStripItem>
                <StackPanel>
                    <icons:SymbolIcon Symbol="Search" />
                    <TextBlock Text="{x:Static lang:Strings.Search}" />
                </StackPanel>
            </TabStripItem>
            <!--  Bezier Curve Square / Data Line  -->
            <TabStripItem>
                <StackPanel>
                    <icons:SymbolIcon Symbol="BezierCurveSquare" />
                    <TextBlock Text="{x:Static lang:Strings.Easings}" />
                </StackPanel>
            </TabStripItem>
            <TabStripItem IsSelected="True">
                <StackPanel>
                    <icons:SymbolIcon Symbol="ArrowStepIn" />
                    <TextBlock Text="{x:Static lang:Strings.SourceOperators}" />
                </StackPanel>
            </TabStripItem>
            <TabStripItem>
                <StackPanel>
                    <icons:SymbolIcon Symbol="Flow" />
                    <TextBlock Text="{x:Static lang:Strings.NodeTree}" />
                </StackPanel>
            </TabStripItem>
        </TabStrip>

        <Carousel Grid.Row="1"
                  Padding="8"
                  SelectedIndex="{Binding #tabStrip.SelectedIndex}">
            <Grid RowDefinitions="Auto,8,*">
                <TextBox x:Name="SearchBox"
                         Classes="clearButton"
                         InputMethod.IsInputMethodEnabled="True"
                         Watermark="{x:Static lang:Strings.Search}" />

                <ListBox x:Name="searchResult"
                         Grid.Row="2"
                         Items="{Binding AllItems}">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel DataContext="{Binding Value}" Spacing="2">
                                <TextBlock Text="{Binding FullDisplayName}" TextTrimming="{x:Static TextTrimming.LeadingCharacterEllipsis}" />
                                <WrapPanel Orientation="Horizontal">
                                    <WrapPanel.Styles>
                                        <Style Selector="TextBlock">
                                            <Setter Property="Theme" Value="{StaticResource LabelTextBlockStyle}" />
                                            <Setter Property="FontSize" Value="12" />
                                        </Style>
                                    </WrapPanel.Styles>
                                    <TextBlock IsVisible="{Binding !!Description}" Text="{Binding Description}" />
                                    <TextBlock Text=" | ">
                                        <TextBlock.IsVisible>
                                            <MultiBinding Converter="{x:Static BoolConverters.And}">
                                                <Binding Converter="{x:Static StringConverters.IsNotNullOrEmpty}" Path="Description" />
                                                <Binding Converter="{x:Static StringConverters.IsNotNullOrEmpty}" Path="Type" />
                                            </MultiBinding>
                                        </TextBlock.IsVisible>
                                    </TextBlock>
                                    <TextBlock IsVisible="{Binding !!Type}" Text="{Binding Type}" />
                                </WrapPanel>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Grid>

            <ScrollViewer>
                <ItemsControl x:Name="itemsControl" Items="{Binding Easings}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel Orientation="Horizontal" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Margin="8,25"
                                    Background="Transparent"
                                    BorderBrush="{DynamicResource TextControlForeground}"
                                    BorderThickness="1">
                                <anmeditors:EasingGraph Width="100"
                                                        Height="100"
                                                        ClipToBounds="False"
                                                        Easing="{Binding}" />
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>

            <TreeView x:Name="OperatorTree"
                      Items="{Binding Operators}"
                      SelectionMode="Single">
                <TreeView.ItemTemplate>
                    <TreeDataTemplate ItemsSource="{Binding Children}">
                        <TextBlock Text="{Binding DisplayName}" />
                    </TreeDataTemplate>
                </TreeView.ItemTemplate>
            </TreeView>

            <TreeView x:Name="NodeTreeView"
                      Items="{Binding Nodes}"
                      SelectionMode="Single">
                <TreeView.ItemTemplate>
                    <TreeDataTemplate ItemsSource="{Binding Children}">
                        <TextBlock Text="{Binding DisplayName}" />
                    </TreeDataTemplate>
                </TreeView.ItemTemplate>
            </TreeView>
        </Carousel>


    </Grid>
</UserControl>
