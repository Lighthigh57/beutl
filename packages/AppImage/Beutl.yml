app: Beutl
binpatch: true
ingredients:
  dist: noble
  sources:
    - deb http://archive.ubuntu.com/ubuntu/ noble main universe
  packages:
    - libgtk-3-0t64
    # OpenCvSharp
    # - libopenexr25
    # - libtesseract4
    # - libdc1394-25
    # - libtheora0
    # - libvorbisenc2
    # - libvorbisfile3
    # - libxvidcore4
    - ffmpeg
    - libopenal1
    # Avalonia
    - libx11-6
    - libice6
    - libsm6
    - libfontconfig1
    - ca-certificates
    - tzdata
    - libc6
    - libgcc-s1
    - libgssapi-krb5-2
    - libstdc++6
    - zlib1g
    - libssl3t64
    - libicu74
script:
  - cp -r ../../output/Beutl/ "./usr/lib/Beutl" # 絶対パスでしていする
  - # Copy icon
  - mkdir -p ./usr/share/pixmaps/256x256/app/
  - cp ../ubuntu22.04_amd64/usr/share/pixmaps/beutl_icon.png "./usr/share/pixmaps/256x256/app/Beutl.png"
  - ln -s -f ./usr/share/pixmaps/256x256/app/Beutl.png ./Beutl.png
  - ln -s -f ./Beutl.png ./.DirIcon
  - # Create .desktop file
  - mkdir -p ./usr/share/applications
  - cat > ./usr/share/applications/Beutl.desktop <<\EOF
  - [Desktop Entry]
  - Name=Beutl
  - Comment=video editor
  - Exec=./usr/bin/Beutl
  - Icon=Beutl
  - Terminal=false
  - Type=Application
  - Categories=GNOME;Utility
  - EOF
  - ln -s -f ./usr/share/applications/Beutl.desktop ./Beutl.desktop
  - # Create AppRun script
  - cat > ./usr/bin/Beutl <<\EOF
  - #!/bin/sh
  - HERE=$(dirname $(readlink -f "${0}"))
  - cd ${HERE}/usr/lib/Beutl
  - export LD_LIBRARY_PATH=${HERE}/usr/lib:${HERE}/usr/lib/x86_64-linux-gnu/:${HERE}/lib/x86_64-linux-gnu/:$LD_LIBRARY_PATH
  - EXEC=${HERE}/usr/lib/Beutl/Beutl
  - exec "${EXEC}" "$@"
  - EOF
  - chmod a+x ./usr/bin/Beutl
  - ln -s -f ./usr/bin/Beutl ./AppRun
